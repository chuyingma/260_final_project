---
title: "Disparity"
author: "JY"
date: "November 30, 2017"
output: html_document
---

##BST 260 Final Project
##Group: Chuying Ma, Jingjing Tang, Jie Yin, Xuewei Zhang

This Rmd file is for studying the relationship between environmental exposures and socioeconomic variables


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(gridExtra)

library(maps)
library(ggmap)
library(mapdata)
library(dplyr)
library(dslabs)

library(tidyr)
```

Load data
```{r}
ds_theme_set()
dat <- read.csv("data_3_expo.csv")
```

Q: Are environmental exposure (e.g. PM2.5, ozone, greenness) disproportionately impact poor and minority populations across the country?

```{r,warning=FALSE}
##pm2.5 in race
p1 <- dat %>% ggplot(aes(white, pm2.5)) +
  geom_point (alpha = 0.5,col = "lightgreen") +
  geom_smooth(method = "lm")

p2 <- dat %>% ggplot(aes(black, pm2.5)) +
  geom_point (alpha = 0.5,col = "lightgreen") +
  geom_smooth(method = "lm")

p3 <- dat %>% ggplot(aes(asian, pm2.5)) +
  geom_point (alpha = 0.5,col = "lightgreen") +
  geom_smooth(method = "lm")

p4 <- dat %>% ggplot(aes(race_other, pm2.5)) +
  geom_point (alpha = 0.5,col = "lightgreen") +
  geom_smooth(method = "lm")

grid.arrange(p1, p2, p3, p4, ncol=2)
```

```{r,warning=FALSE}
##pm2.5 in income
i1 <- dat %>% ggplot(aes(income1, pm2.5)) +
  geom_point (alpha = 0.5,col = "deepskyblue") +
  geom_smooth(method = "lm")

i2 <- dat %>% ggplot(aes(income2, pm2.5)) +
  geom_point (alpha = 0.5,col = "deepskyblue") +
  geom_smooth(method = "lm")

i3 <- dat %>% ggplot(aes(income3, pm2.5)) +
  geom_point (alpha = 0.5,col = "deepskyblue") +
  geom_smooth(method = "lm")

i4 <- dat %>% ggplot(aes(income4, pm2.5)) +
  geom_point (alpha = 0.5,col = "deepskyblue") +
  geom_smooth(method = "lm")

i5 <- dat %>% ggplot(aes(income5, pm2.5)) +
  geom_point (alpha = 0.5,col = "deepskyblue") +
  geom_smooth(method = "lm")

i6 <- dat %>% ggplot(aes(income6, pm2.5)) +
  geom_point (alpha = 0.5,col = "deepskyblue") +
  geom_smooth(method = "lm")

i7 <- dat %>% ggplot(aes(income7, pm2.5)) +
  geom_point (alpha = 0.5,col = "deepskyblue") +
  geom_smooth(method = "lm")

i8 <- dat %>% ggplot(aes(income8, pm2.5)) +
  geom_point (alpha = 0.5,col = "deepskyblue") +
  geom_smooth(method = "lm")

grid.arrange(i1, i2, i3, i4, i5, i6, i7, i8, ncol=3)
```

```{r,warning=FALSE}
##pm2.5 in education
e1 <- dat %>% ggplot(aes(educ1, pm2.5)) +
  geom_point (alpha = 0.5,col = "darkslategrey") +
  geom_smooth(method = "lm")

e2 <- dat %>% ggplot(aes(educ2, pm2.5)) +
  geom_point (alpha = 0.5,col = "darkslategrey") +
  geom_smooth(method = "lm")

e3 <- dat %>% ggplot(aes(educ3, pm2.5)) +
  geom_point (alpha = 0.5,col = "darkslategrey") +
  geom_smooth(method = "lm")

grid.arrange(e1, e2, e3, ncol=2)
```

Regression: pm2.5 ~ %without colleage degree + %non-white + %in poverty












